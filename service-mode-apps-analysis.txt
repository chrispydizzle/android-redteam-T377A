â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    SAMSUNG SERVICE MODE APPS ANALYSIS REPORT                   â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## 1. com.sec.android.RilServiceModeApp (ServiceModeApp_RIL)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“¦ PACKAGE INFO:
  â€¢ Package Name: com.sec.android.RilServiceModeApp
  â€¢ Location: /system/priv-app/ServiceModeApp_RIL
  â€¢ Version: 6.0.1 (versionCode: 23, targetSdk: 23)
  â€¢ User ID: 1001 (android.uid.phone shared user)
  â€¢ Privileges: PRIVILEGED, SYSTEM
  â€¢ Signatures: Samsung system certificate [9b8a46f]

ğŸ“ MAIN ACTIVITIES (Exported - Launchable via Intent):
  1. ServiceModeApp â† PRIMARY ENTRY POINT
  2. GcfModeSettings
  3. ClatConfiguration
  4. Sec_Ril_Dump
  5. CallDropLogView
  6. SetupWizardSkip
  7. ViewApnInfo
  8. NandFlashHeaderRead
  9. ViewRilLog
  10. TerminalMode âš ï¸ (Terminal-like functionality)
  11. Svc_Dbg_Dump
  12. TestApnSettings
  13. com.marvell.logtools.logSettings.LogToolsMainReceiver

ğŸ”” BROADCAST RECEIVERS (Exported):
  â€¢ android_secret_code â†’ SecKeyStringBroadcastReceiver
    - Listens for secret code sequences (dial *#<code>#)
  â€¢ com.samsung.intent.action.IMS_CALL_DROP â†’ CallDropBroadcastReceiver
  â€¢ com.samsung.intent.action.CALL_DROP â†’ CallDropBroadcastReceiver

ğŸ” DECLARED PERMISSIONS (Privileged):
  â€¢ com.sec.android.app.servicemodeapp.permission.KEYSTRING
    - Protection Level: signature|privileged (requires system signature)

ğŸš€ CRITICAL REQUESTED PERMISSIONS (Selection):
  âœ“ WRITE_SETTINGS - Modify system settings
  âœ“ WRITE_SECURE_SETTINGS - Modify secure settings
  âœ“ MOUNT_UNMOUNT_FILESYSTEMS - File system access
  âœ“ MODIFY_PHONE_STATE - Control phone/modem state
  âœ“ WRITE_APN_SETTINGS - Modify APN configuration
  âœ“ CALL_PHONE - Make phone calls
  âœ“ CLEAR_APP_USER_DATA - Clear any app's data
  âœ“ DEVICE_POWER - Control device power
  âœ“ READ_LOGS - Access system logs
  âœ“ WRITE_EXTERNAL_STORAGE - Modify /sdcard
  âœ“ CHANGE_NETWORK_STATE - Modify network state
  âœ“ MASTER_CLEAR - Factory reset
  âœ“ SHUTDOWN - Shut down device
  âœ“ DUMP - Access dumpsys (system diagnostics)
  âœ“ MASTER_CLEAR - Device reset
  âœ“ CALL_PRIVILEGED - Make privileged calls
  âœ“ BROADCAST_SMS - Send SMS broadcasts
  âœ“ MANAGE_USERS - User account management
  âœ“ SET_TIME - Set system time
  âœ“ INTERACT_ACROSS_USERS_FULL - Cross-user access
  âœ“ BROADCAST_STICKY - Persistent broadcasts
  âœ“ BLUETOOTH_ADMIN - Bluetooth control
  âœ“ MANAGE_ACCOUNTS - Account management
  âœ“ INSTALL_PACKAGES - Install apps
  âœ“ READ_PRIVILEGED_PHONE_STATE
  
All permissions are GRANTED with no restrictions.

âš ï¸ ATTACK SURFACE:
  â€¢ Secret code listener - Can trigger via dial pad
  â€¢ TerminalMode activity suggests shell/command interface
  â€¢ Direct modem/RIL access
  â€¢ APN/network configuration access
  â€¢ Log viewing capabilities
  â€¢ System-level settings modification


## 2. com.sec.android.app.servicemodeapp (serviceModeApp_FB)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“¦ PACKAGE INFO:
  â€¢ Package Name: com.sec.android.app.servicemodeapp
  â€¢ Location: /system/priv-app/serviceModeApp_FB
  â€¢ Version: 6.0.1 (versionCode: 23, targetSdk: 23)
  â€¢ User ID: 1000 (android.uid.system shared user)
  â€¢ Privileges: PRIVILEGED, SYSTEM
  â€¢ Signatures: Samsung system certificate [9b8a46f]

ğŸ“ MAIN ACTIVITIES (Exported - Launchable via Intent):
  1. PhoneUtil_ESC â† Qualcomm MDM9x35 modem debug
  2. AutoAnswer âš ï¸ (Auto-answer calls)
  3. PhoneUtil_Bcom â† Broadcom modem
  4. CPDebugLevel
  5. ResetTotalCallTime
  6. PhoneUtil_MarvellVIA â† Marvell VIA modem
  7. PhoneUtil_TD â† TD-SCDMA modem
  8. PhoneUtil_SGLTE â† Single Radio Voice Call Continuity
  9. PhoneUtil (Generic)
  10. USBPathSwitch âš ï¸ (USB mode switching)
  11. ShowIMEI (Display IMEI)
  12. USBSettings âš ï¸ (USB configuration)
  13. DebugLevel
  14. WifiInfoActivity
  15. RTN_View (Return/Reset?)
  16. PhoneUtil_MDM9x15 â† Qualcomm MDM9x15 modem
  17. SetPortUartUsbMSM8960 â† MSM8960 modem UART/USB config
  18. PhoneUtil_Prevail2SPR
  19. SetPortUartUSBCTCModel â† UART/USB configuration
  20. SysDumpReceiver

ğŸ”” BROADCAST RECEIVERS (Exported):
  â€¢ android_secret_code â†’ ServiceModeAppBroadcastReceiver
    - Listens for secret codes (dial *#<code>#)
  â€¢ com.samsung.intent.action.SEC_FACTORY_RESET_WITHOUT_FACTORY_UI â†’ ServiceModeAppBroadcastReceiver
    - Allows factory reset without UI! âš ï¸âš ï¸âš ï¸
  â€¢ com.samsung.intent.WIFIINFO â†’ WifiInfoBroadcastReceiver
  â€¢ com.sec.android.app.servicemodeapp.NOTIDUMP_OFF â†’ ServiceModeAppBroadcastReceiver
  â€¢ com.sec.FTAT_DUMP â†’ FTATDumpReceiver
  â€¢ android.intent.action.BOOT_COMPLETED â†’ ServiceModeAppBroadcastReceiver
  â€¢ com.samsung.systemui.power.action.LOW_BATTERY_DUMP â†’ FTATDumpReceiver

ğŸ” DECLARED PERMISSIONS (Privileged):
  â€¢ com.sec.android.app.servicemodeapp.permission.KEYSTRING
    - Protection Level: signature|privileged

ğŸš€ CRITICAL REQUESTED PERMISSIONS (Selection):
  âœ“ WRITE_SETTINGS - Modify system settings
  âœ“ WRITE_SECURE_SETTINGS - Modify secure settings
  âœ“ MOUNT_UNMOUNT_FILESYSTEMS - File system access
  âœ“ MODIFY_PHONE_STATE - Control phone/modem state
  âœ“ WRITE_APN_SETTINGS - Modify APN configuration
  âœ“ CALL_PHONE - Make phone calls
  âœ“ CLEAR_APP_USER_DATA - Clear app data
  âœ“ DEVICE_POWER - Control power
  âœ“ READ_LOGS - Access logs
  âœ“ WRITE_EXTERNAL_STORAGE - Modify storage
  âœ“ CHANGE_NETWORK_STATE - Network control
  âœ“ MASTER_CLEAR - Factory reset âš ï¸
  âœ“ RECEIVE_BOOT_COMPLETED - Run at startup
  âœ“ HARDWARE_TEST - Hardware testing
  âœ“ NFC - NFC control
  âœ“ VIBRATE
  âœ“ BLUETOOTH_ADMIN - Bluetooth control
  âœ“ MODIFY_AUDIO_SETTINGS - Audio control
  âœ“ READ_PHONE_STATE
  âœ“ READ_CONTACTS
  âœ“ WRITE_CONTACTS
  âœ“ WRITE_MEDIA_STORAGE - Modify media storage
  âœ“ READ_EXTERNAL_STORAGE
  âœ“ READ_LOGS
  âœ“ INSTALL_PACKAGES - Install apps
  âœ“ CHANGE_COMPONENT_ENABLED_STATE - Enable/disable components
  âœ“ BROADCAST_SMS - Send SMS
  âœ“ CALL_PRIVILEGED - Privileged calls
  âœ“ MANAGE_ACCOUNTS - Account control
  âœ“ MANAGE_USERS - User management
  âœ“ SHUTDOWN - Device shutdown
  âœ“ SET_TIME - Set time/date
  
All permissions are GRANTED with no restrictions.

âš ï¸ CRITICAL VULNERABILITIES/ATTACK SURFACE:
  â€¢ AutoAnswer activity - Can answer incoming calls automatically
  â€¢ USBPathSwitch + USBSettings - Modify USB behavior (ADB mode, MTP, etc)
  â€¢ UART/USB port switching for modem communication
  â€¢ Factory reset without UI dialog via broadcast
  â€¢ Secret code listener at *#<code>#
  â€¢ FTAT dump (Full Test Analysis and Troubleshooting) - extensive diagnostics
  â€¢ Modem-specific PhoneUtil variants suggest deep modem access
  â€¢ BOOT_COMPLETED receiver - Persists across reboots


## EXPLOITATION SUMMARY
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ”“ LAUNCH METHODS:

1. Via Dial Code (Secret Codes):
   - Dial: *#<CODE>#
   - Received by: SecKeyStringBroadcastReceiver (both apps)
   - No user interaction needed for intent dispatch

2. Via Explicit Intent:
   am start -n com.sec.android.RilServiceModeApp/.ServiceModeApp
   am start -n com.sec.android.app.servicemodeapp/.PhoneUtil_ESC
   am start -n com.sec.android.app.servicemodeapp/.AutoAnswer

3. Via Broadcast Intent:
   adb shell am broadcast -a com.samsung.intent.action.SEC_FACTORY_RESET_WITHOUT_FACTORY_UI \
     com.sec.android.app.servicemodeapp
   âš ï¸ FACTORY RESET WITHOUT CONFIRMATION!

4. Via Permission-less Broadcast Receiver:
   - Broadcast to android_secret_code scheme
   - ServiceModeAppBroadcastReceiver catches it
   - Can trigger various functions

ğŸ¯ HIGH-IMPACT CAPABILITIES:

From RilServiceModeApp:
  â€¢ Access to RIL (Radio Interface Layer) logs and diagnostics
  â€¢ Modify APN (Access Point Name) settings
  â€¢ Call state manipulation
  â€¢ NandFlash diagnostics/manipulation
  â€¢ Terminal mode (potential shell access)
  â€¢ System log reading

From servicemodeapp:
  â€¢ AUTO-ANSWER incoming calls
  â€¢ Factory reset (without UI!)
  â€¢ USB mode switching (enable/disable ADB)
  â€¢ IMEI manipulation/viewing
  â€¢ Modem-specific configuration (Qualcomm, Broadcom, Marvell)
  â€¢ Audio/Network/Power control

ğŸ”‘ KEY PERMISSIONS ENABLING ATTACKS:
  â€¢ MODIFY_PHONE_STATE - Manipulate call state
  â€¢ MASTER_CLEAR - Factory reset device
  â€¢ WRITE_APN_SETTINGS - Redirect data to attacker
  â€¢ CHANGE_COMPONENT_ENABLED_STATE - Enable/disable security components
  â€¢ CHANGE_NETWORK_STATE - Modify network connectivity
  â€¢ SHUTDOWN - Force device offline
  â€¢ BLUETOOTH_ADMIN - Control BT (sidechannel exfil)


## DETECTION & MITIGATION
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Detection:
  âœ“ Monitor for secret code dials (*#*#<code>#*#*)
  âœ“ Monitor APN settings changes
  âœ“ Log system-wide broadcasts
  âœ“ Track USB mode changes
  âœ“ Monitor factory reset commands
  âœ“ Alert on TerminalMode/PhoneUtil activity starts

Mitigation:
  â€¢ Disable secret code dial handling (if possible)
  â€¢ Use MDM to restrict APN modifications
  â€¢ Disable USB debugging on production devices
  â€¢ Restrict broadcast receivers (adb shell pm disable)
  â€¢ Monitor for unauthorized app launches