â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘          SERVICE MODE APPS - DETAILED PERMISSIONS BREAKDOWN                   â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## PERMISSION MATRIX
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Permission Name                          | RilServiceModeApp | servicemodeapp | Threat Level
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
WRITE_SETTINGS                           |        âœ“          |       âœ“        | CRITICAL
WRITE_SECURE_SETTINGS                    |        âœ“          |       âœ“        | CRITICAL
MOUNT_UNMOUNT_FILESYSTEMS                |        âœ“          |       âœ“        | CRITICAL
MODIFY_PHONE_STATE                       |        âœ“          |       âœ“        | CRITICAL
WRITE_APN_SETTINGS                       |        âœ“          |       âœ“        | CRITICAL
MASTER_CLEAR                             |        âœ“          |       âœ“        | CRITICAL
CHANGE_CONFIGURATION                     |        âœ“          |       âœ“        | CRITICAL
READ_PRIVILEGED_PHONE_STATE              |        âœ“          |       âœ“        | HIGH
CHANGE_COMPONENT_ENABLED_STATE           |        âœ“          |       âœ“        | HIGH
CHANGE_NETWORK_STATE                     |        âœ“          |       âœ“        | HIGH
SHUTDOWN                                 |        âœ“          |       âœ“        | HIGH
CALL_PHONE                               |        âœ“          |       âœ“        | HIGH
CALL_PRIVILEGED                          |        âœ“          |       âœ“        | HIGH
MODIFY_AUDIO_SETTINGS                    |        âœ—          |       âœ“        | MEDIUM
DEVICE_POWER                             |        âœ“          |       âœ“        | MEDIUM
READ_LOGS                                |        âœ“          |       âœ“        | MEDIUM
WRITE_EXTERNAL_STORAGE                   |        âœ“          |       âœ“        | MEDIUM
READ_EXTERNAL_STORAGE                    |        âœ“          |       âœ“        | MEDIUM
INSTALL_PACKAGES                         |        âœ“          |       âœ“        | MEDIUM
MANAGE_ACCOUNTS                          |        âœ“          |       âœ“        | MEDIUM
MANAGE_USERS                             |        âœ“          |       âœ“        | MEDIUM
CLEAR_APP_USER_DATA                      |        âœ“          |       âœ“        | MEDIUM
ACCESS_NETWORK_STATE                     |        âœ“          |       âœ“        | LOW
INTERNET                                 |        âœ“          |       âœ“        | LOW
BROADCAST_SMS                            |        âœ“          |       âœ“        | HIGH
WRITE_CONTACTS                           |        âœ—          |       âœ“        | MEDIUM
READ_CONTACTS                            |        âœ—          |       âœ“        | MEDIUM
NFC                                      |        âœ—          |       âœ“        | MEDIUM
HARDWARE_TEST                            |        âœ—          |       âœ“        | MEDIUM
BLUETOOTH_ADMIN                          |        âœ“          |       âœ“        | MEDIUM


## CRITICAL PERMISSION DETAILS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ”´ MASTER_CLEAR
  â”œâ”€ What it does: Factory reset the entire device
  â”œâ”€ Granted to: Both RilServiceModeApp and servicemodeapp
  â”œâ”€ Risk: Can erase all user data without confirmation
  â”œâ”€ Abuse: com.samsung.intent.action.SEC_FACTORY_RESET_WITHOUT_FACTORY_UI broadcast
  â””â”€ Mitigation: Disable broadcast receiver, monitor factory reset calls

ğŸ”´ MODIFY_PHONE_STATE
  â”œâ”€ What it does: Control phone/modem state, answer/end calls, set call forwarding
  â”œâ”€ Related to: android.permission.CALL_PHONE (make calls), CALL_PRIVILEGED
  â”œâ”€ Risk: Full call control, can redirect calls, conference calls
  â”œâ”€ Abuse: Can listen to any call, activate/deactivate call forwarding to attacker
  â””â”€ Impact: Intercept all communications

ğŸ”´ WRITE_APN_SETTINGS
  â”œâ”€ What it does: Modify Access Point Names (APN) for data connectivity
  â”œâ”€ Granted to: Both apps via RilServiceModeApp activities
  â”œâ”€ Risk: Redirect all mobile data through attacker's infrastructure
  â”œâ”€ Abuse: MITM attacks on 3G/4G data, SMS theft, email interception
  â”œâ”€ Example victims: Banking apps, messaging, email, social media
  â””â”€ Detection: Monitor APN database changes at /data/misc/apn/apns-conf.xml

ğŸ”´ WRITE_SECURE_SETTINGS
  â”œâ”€ What it does: Modify secure system settings (airplane mode, 5G, network selection)
  â”œâ”€ Granted to: Both apps
  â”œâ”€ Risk: Disable network connectivity, disable WiFi, disable Bluetooth
  â”œâ”€ Abuse: Force device to use specific network (3G instead of 4G for interception)
  â””â”€ Related to: CHANGE_NETWORK_STATE, CHANGE_CONFIGURATION

ğŸ”´ CHANGE_COMPONENT_ENABLED_STATE
  â”œâ”€ What it does: Enable/disable any application component
  â”œâ”€ Risk: Disable security apps (anti-malware, VPN, MDM), enable malware
  â”œâ”€ Abuse: Disable Google Play Protect, knox, Samsung security components
  â”œâ”€ Example: pm disable com.android.internal.protips (disable warnings)
  â””â”€ Impact: Disarm all device security in seconds

ğŸ”´ SHUTDOWN
  â”œâ”€ What it does: Force device shutdown/restart
  â”œâ”€ Risk: Causes denial of service, forces reboot into insecure state
  â”œâ”€ Abuse: Trigger boot-time attacks, disable secure boot verification
  â””â”€ Impact: Device unusable, loss of control

ğŸ”´ MOUNT_UNMOUNT_FILESYSTEMS
  â”œâ”€ What it does: Mount/unmount /system, /data, SD card partitions
  â”œâ”€ Risk: Access/modify system files directly, bypass app sandboxing
  â”œâ”€ Abuse: Modify system apk files, inject code into system apps
  â”œâ”€ Example: Modify /system/app/SystemUI.apk to steal everything
  â””â”€ Impact: Full device compromise, invisible malware

ğŸŸ  CHANGE_CONFIGURATION
  â”œâ”€ What it does: Change system locale, language, UI layout
  â”œâ”€ Risk: Change to attacker-controlled input method, keyboard
  â”œâ”€ Abuse: Replace keyboard with keylogger, screenshot logger
  â””â”€ Impact: Capture all user input

ğŸŸ  READ_PRIVILEGED_PHONE_STATE
  â”œâ”€ What it does: Read phone state, call details, IMSI, IMEI, subscription info
  â”œâ”€ Risk: Extract device identity, phone number, subscriber data
  â”œâ”€ Abuse: Phone number enumeration, identity theft, SIM card info
  â””â”€ Impact: Device fingerprinting, targeted attacks

ğŸŸ  INSTALL_PACKAGES
  â”œâ”€ What it does: Install APK files programmatically
  â”œâ”€ Granted to: Both apps
  â”œâ”€ Risk: Install malware without user consent
  â”œâ”€ Abuse: Silent installation of spyware, rootkit apps
  â””â”€ Detection: Monitor /data/app directory and pm install command

ğŸŸ  BROADCAST_SMS
  â”œâ”€ What it does: Send SMS broadcasts
  â”œâ”€ Risk: Trigger system SMS broadcasts, intercept SMS delivery
  â”œâ”€ Abuse: Cause device to process malicious SMS without notification
  â””â”€ Related: SEND_SMS (not granted, but BROADCAST_SMS is more dangerous)

ğŸŸ  CALL_PRIVILEGED
  â”œâ”€ What it does: Make emergency and privileged calls
  â”œâ”€ Risk: Bypass normal call restrictions, call any number
  â”œâ”€ Abuse: Make calls to premium numbers, call emergency services, SWAT
  â””â”€ Impact: Financial theft, emergency abuse


## PERMISSION ESCALATION CHAINS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

CHAIN 1: From App Crash â†’ Full Device Control
  Step 1: CHANGE_COMPONENT_ENABLED_STATE
           â””â”€ Disable com.sec.android.app.servicemodeapp
  Step 2: INSTALL_PACKAGES
           â””â”€ Install malicious app as system app via /system partition
  Step 3: MOUNT_UNMOUNT_FILESYSTEMS
           â””â”€ Mount /system as RW
           â””â”€ Install backdoor in /system/priv-app
  Step 4: Device now has persistent system-level malware

CHAIN 2: Data Exfiltration
  Step 1: WRITE_APN_SETTINGS
           â””â”€ Modify APN to point to attacker.com
  Step 2: CHANGE_NETWORK_STATE
           â””â”€ Force device to use modified APN
  Step 3: Now all data flows through attacker
           â”œâ”€ Banking credentials captured
           â”œâ”€ Messages/emails read
           â”œâ”€ Authentication tokens stolen
           â””â”€ 2FA codes intercepted

CHAIN 3: Silent Surveillance
  Step 1: MODIFY_PHONE_STATE + CALL_PHONE
           â””â”€ Programmatically answer all calls
  Step 2: MODIFY_AUDIO_SETTINGS
           â””â”€ Disable microphone, enable speaker
  Step 3: READ_EXTERNAL_STORAGE + INSTALL_PACKAGES
           â””â”€ Deploy recording service to /system
  Step 4: Call microphone hijacked, all communications recorded

CHAIN 4: Device Lockdown
  Step 1: MASTER_CLEAR
           â””â”€ Factory reset to known state
  Step 2: MOUNT_UNMOUNT_FILESYSTEMS
           â””â”€ Mount /system RW, install custom ROM
  Step 3: CHANGE_COMPONENT_ENABLED_STATE
           â””â”€ Disable all user-facing security
  Step 4: Device is now fully attacker-controlled


## BROADCAST RECEIVERS & INTENT FILTERS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

RilServiceModeApp Broadcasts:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ACTION: android_secret_code                                                 â”‚
â”‚ HANDLER: com.sec.android.RilServiceModeApp/.SecKeyStringBroadcastReceiver  â”‚
â”‚ ACCESSIBILITY: Public (no permission required to send)                      â”‚
â”‚ TRIGGERED BY: Dial pad input *#<code>#                                     â”‚
â”‚ PURPOSE: Intercept secret code sequences for service menus                  â”‚
â”‚ RISK: No user confirmation, immediate action                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

servicemodeapp Broadcasts:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ACTION: android_secret_code                                                 â”‚
â”‚ HANDLER: com.sec.android.app.servicemodeapp/.ServiceModeAppBroadcastReceiver
â”‚ ACCESSIBILITY: Public (dial *#<code>#)                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ACTION: com.samsung.intent.action.SEC_FACTORY_RESET_WITHOUT_FACTORY_UI    â”‚
â”‚ HANDLER: ServiceModeAppBroadcastReceiver                                    â”‚
â”‚ ACCESSIBILITY: Requires MASTER_CLEAR + privileged app status               â”‚
â”‚ RISK: âš ï¸âš ï¸âš ï¸ Factory resets WITHOUT confirmation dialog                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ACTION: com.samsung.intent.action.CALL_DROP                                 â”‚
â”‚ HANDLER: CallDropBroadcastReceiver                                          â”‚
â”‚ PURPOSE: Log call drops for diagnostics                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ACTION: com.samsung.intent.WIFIINFO                                         â”‚
â”‚ HANDLER: WifiInfoBroadcastReceiver                                          â”‚
â”‚ PURPOSE: Collect WiFi information                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ACTION: com.sec.FTAT_DUMP                                                   â”‚
â”‚ HANDLER: FTATDumpReceiver                                                   â”‚
â”‚ PURPOSE: Full Test Analysis & Troubleshooting dump                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ACTION: android.intent.action.BOOT_COMPLETED                                â”‚
â”‚ HANDLER: ServiceModeAppBroadcastReceiver                                    â”‚
â”‚ RISK: Runs on every device boot, can execute persistent code               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ACTION: com.samsung.systemui.power.action.LOW_BATTERY_DUMP                 â”‚
â”‚ HANDLER: FTATDumpReceiver                                                   â”‚
â”‚ PURPOSE: Dump device state on low battery                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


## SHARED USER ELEVATION
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

RilServiceModeApp:
  Shared User: android.uid.phone (UID 1001)
  Shared With:
    â€¢ com.android.phone (Phone app)
    â€¢ com.android.internal.telephony (Telephony system service)
    â€¢ Any other app using android.uid.phone
  Implication: Can access data/cache of phone-related apps

servicemodeapp:
  Shared User: android.uid.system (UID 1000)
  Shared With:
    â€¢ framework-res.apk
    â€¢ android.system.ui.* (System UI)
    â€¢ Most system services
  Implication: Can access ALL system app data (highest privilege)


## MANIFEST EXPORTED COMPONENTS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

From dumpsys analysis, the following are EXPORTED (no android:exported="false"):

RilServiceModeApp:
  â€¢ All 13 Activities (including TerminalMode) â† CRITICAL
  â€¢ SecKeyStringBroadcastReceiver
  â€¢ CallDropBroadcastReceiver

servicemodeapp:
  â€¢ All 20 Activities (including AutoAnswer, USBPathSwitch) â† CRITICAL
  â€¢ ServiceModeAppBroadcastReceiver
  â€¢ WifiInfoBroadcastReceiver
  â€¢ FTATDumpReceiver

EXPORTED = Can be launched by ANY app without declaring specific permissions


## DEFENSE CHECKLIST
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

â–¡ Disable both service mode apps:
  pm disable com.sec.android.RilServiceModeApp
  pm disable com.sec.android.app.servicemodeapp

â–¡ Disable individual broadcast receivers:
  pm disable com.sec.android.RilServiceModeApp/.SecKeyStringBroadcastReceiver
  pm disable com.sec.android.app.servicemodeapp/.ServiceModeAppBroadcastReceiver

â–¡ Block secret code handling at system level:
  settings put secure secret_codes_enabled 0

â–¡ Lock down APN modifications:
  settings put global allow_user_preferred_apn 0

â–¡ Monitor for component enable/disable:
  adb logcat | grep "change enabled"

â–¡ Monitor for factory reset attempts:
  adb logcat | grep -i "factory reset"

â–¡ Monitor for USB path switching:
  adb logcat | grep -i "usb.*path\|usb.*switch"

â–¡ Lock down privileged broadcasts:
  Restrict who can send SEC_FACTORY_RESET_WITHOUT_FACTORY_UI

â–¡ Audit file system mounts:
  mount | grep "/system"

â–¡ Monitor system partition modifications:
  stat -c "%a %A" /system/*
